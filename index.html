<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gantt Chart Generator</title>
  <link rel="stylesheet" href="css/style.css?v=20">
</head>
<body>

  <!-- ===== TOOLBAR ===== -->
  <header id="toolbar">
    <div class="toolbar-left">
      <span class="app-title">Gantt Chart</span>
      <div class="toolbar-divider"></div>
      <button id="btn-toggle-panel" title="Toggle editor panel">
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M1 2h12M1 7h8M1 12h12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
      </button>
      <button id="btn-add-task" data-tooltip="Ctrl/⌘ + N">
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M7 1v12M1 7h12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        Task
      </button>
      <button id="btn-add-milestone" data-tooltip="Add milestone marker">
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M7 1l4.5 6-4.5 6-4.5-6z" stroke="currentColor" stroke-width="1.5" fill="none"/></svg>
        Milestone
      </button>
      <button id="btn-delete-task" data-tooltip="Delete / Backspace" class="btn-danger" disabled>
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M2 4h10M5 4V2h4v2M4 4v8h6V4" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        Delete
      </button>
      <div class="toolbar-divider"></div>
      <button id="btn-scopes" title="Manage Scopes">
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><rect x="1" y="2" width="4" height="4" rx="1" fill="currentColor" opacity=".5"/><rect x="7" y="2" width="6" height="1.5" rx=".5" fill="currentColor" opacity=".4"/><rect x="1" y="8" width="4" height="4" rx="1" fill="currentColor" opacity=".5"/><rect x="7" y="8" width="6" height="1.5" rx=".5" fill="currentColor" opacity=".4"/></svg>
        Scopes
      </button>
      <button id="btn-settings" title="Plan Settings">
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><circle cx="7" cy="7" r="2.5" stroke="currentColor" stroke-width="1.2"/><path d="M7 1v2M7 11v2M1 7h2M11 7h2M2.8 2.8l1.4 1.4M9.8 9.8l1.4 1.4M11.2 2.8l-1.4 1.4M4.2 9.8l-1.4 1.4" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/></svg>
        Settings
      </button>
    </div>
    <div class="toolbar-right">
      <button id="btn-sample" title="Load Sample Project">Sample</button>
      <div class="toolbar-divider"></div>
      <button id="btn-import" title="Import JSON">
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M1 10v2h12v-2M7 1v8M3 6l4 4 4-4" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        Import
      </button>
      <button id="btn-export-json" title="Export JSON">
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M1 10v2h12v-2M7 9V1M3 4l4-4 4 4" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        JSON
      </button>
      <div class="toolbar-divider"></div>
      <button id="btn-export-pptx" class="btn-primary" data-tooltip="Ctrl/⌘ + E">
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><rect x="1" y="1" width="12" height="12" rx="2" stroke="currentColor" stroke-width="1.2"/><text x="4" y="10.5" font-size="8" font-weight="700" fill="currentColor">P</text></svg>
        Export PPTX
      </button>
    </div>
  </header>

  <!-- ===== MAIN CONTENT ===== -->
  <main id="app">
    <!-- LEFT: Task Editor Table -->
    <section id="task-panel">
      <div id="task-table-wrapper">
        <table id="task-table">
          <thead>
            <tr>
              <th class="col-handle"></th>
              <th class="col-name">Activity</th>
              <th class="col-start">Start</th>
              <th class="col-end">End</th>
              <th class="col-scope">Scope</th>
              <th class="col-status">Status</th>
              <th class="col-comment">Comment</th>
              <th class="col-style">Style</th>
            </tr>
          </thead>
          <tbody id="task-tbody"></tbody>
        </table>
      </div>
      <div id="activity-ms-panel" class="hidden">
        <div class="ams-header">
          <span class="ams-title">Activity Milestones</span>
          <button id="btn-add-ams" class="btn-sm">+ Add</button>
        </div>
        <div id="ams-list"></div>
      </div>
      <div id="empty-state" class="hidden">
        <p>No tasks yet.</p>
        <p>Click <strong>+ Task</strong> to get started or load the <strong>Sample</strong> project.</p>
      </div>
    </section>

    <!-- Resizer -->
    <div id="panel-resizer"></div>

    <!-- RIGHT: Think-cell Gantt Chart -->
    <section id="gantt-panel">
      <!-- Zoom Control -->
      <div id="zoom-bar">
        <span class="zoom-label">−</span>
        <input type="range" id="zoom-slider" min="40" max="200" value="100" step="5" />
        <span class="zoom-label">+</span>
        <span id="zoom-value">100%</span>
      </div>
      <div id="gantt-container"></div>
    </section>
  </main>

  <!-- ===== SCOPE MANAGEMENT MODAL ===== -->
  <div id="scope-modal" class="modal-overlay hidden">
    <div class="modal-box">
      <div class="modal-header">
        <h3>Manage Scopes</h3>
        <button id="btn-close-scopes" class="btn-icon">&times;</button>
      </div>
      <div class="modal-body">
        <div id="scope-list"></div>
        <button id="btn-add-scope" class="btn-sm" style="margin-top:8px">+ Add Scope</button>
      </div>
    </div>
  </div>

  <!-- ===== SETTINGS MODAL ===== -->
  <div id="settings-modal" class="modal-overlay hidden">
    <div class="modal-box">
      <div class="modal-header">
        <h3>Plan Settings</h3>
        <button id="btn-close-settings" class="btn-icon">&times;</button>
      </div>
      <div class="modal-body">
        <div class="settings-group">
          <label class="settings-label">Date Format</label>
          <select id="setting-date-format" class="settings-select">
            <option value="DD.MM.YYYY">DD.MM.YYYY</option>
            <option value="MM/DD/YYYY">MM/DD/YYYY</option>
            <option value="YYYY-MM-DD">YYYY-MM-DD</option>
            <option value="DD MMM YYYY">DD MMM YYYY</option>
            <option value="MMM DD">MMM DD</option>
          </select>
        </div>
        <div class="settings-group">
          <label class="settings-label">Time Scale</label>
          <div class="settings-checkboxes">
            <label><input type="checkbox" id="setting-ts-years" checked /> Years</label>
            <label><input type="checkbox" id="setting-ts-months" checked /> Months</label>
            <label><input type="checkbox" id="setting-ts-weeks" checked /> Weeks</label>
          </div>
        </div>
        <div class="settings-group">
          <label class="settings-label">
            <input type="checkbox" id="setting-show-today" checked />
            Show TODAY marker
          </label>
        </div>
        <div class="settings-group">
          <label class="settings-label">
            <input type="checkbox" id="setting-show-ms-dates" checked />
            Show dates on milestones
          </label>
        </div>
        <div class="settings-group">
          <label class="settings-label">Milestone color</label>
          <input type="color" id="setting-ms-color" value="#37474F" class="scope-color-picker" />
        </div>
        <div class="settings-group settings-group-vertical">
          <label class="settings-label">Preset Milestone Colors</label>
          <div style="display:flex;align-items:center;gap:6px;flex-wrap:wrap">
            <div id="preset-ms-colors-list" style="display:flex;gap:4px;flex-wrap:wrap"></div>
            <input type="color" id="new-preset-color" value="#607D8B" class="scope-color-picker" />
            <button id="btn-add-preset-color" class="btn-sm">+ Add</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Hidden file input for JSON import -->
  <input type="file" id="file-import" accept=".json" class="hidden">

  <!-- Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>

  <!-- App Scripts -->
  <script src="js/app.js?v=20"></script>
  <script src="js/gantt-render.js?v=20"></script>
  <script src="js/pptx-export.js?v=20"></script>
</body>
</html>
